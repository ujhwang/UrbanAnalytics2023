"0","# Function: Get tract-wise radius"
"0","get_r <- function(poly, epsg_id){"
"0","  #---------------------"
"0","  # Takes: a single POLYGON or LINESTRTING"
"0","  # Outputs: distance between the centroid of the boundingbox and a corner of the bounding box"
"0","  #---------------------"
"0","  "
"0","  # Get bounding box of a given polygon"
"0","  bb <- st_bbox(poly)"
"0","  # Get lat & long coordinates of any one corner of the bounding box."
"0","  bb_corner <- st_point(c(bb[1], bb[2])) %>% st_sfc(crs = epsg_id)"
"0","  # Get centroid of the bb"
"0","  bb_center_x <- (bb[3]+bb[1])/2"
"0","  bb_center_y <- (bb[4]+bb[2])/2"
"0","  bb_center <- st_point(c(bb_center_x, bb_center_y)) %>% st_sfc(crs = epsg_id) %>% st_sf()"
"0","    "
"0","  # Get the distance between bb_p and c"
"0","  r <- st_distance(bb_corner, bb_center)"
"0","  # Multiply 1.1 to make the circle a bit larger than the Census Tract."
"0","  # See the Yelp explanation of their radius parameter to see why we do this."
"0","  bb_center$radius <- r*1.2"
"0","  return(bb_center)"
"0","}"
